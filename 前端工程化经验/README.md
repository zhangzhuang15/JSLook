## ä¸ºä»€ä¹ˆæœ‰æœ¬ç« èŠ‚ï¼Ÿ
æ— è®ºä½ æ˜¯
* å‰ç«¯ app åº”ç”¨ç¨‹åºçš„å¼€å‘è€…
* node command line ç¨‹åºçš„å¼€å‘è€…
* å‰ç«¯å¼€æºåº“æˆ–è€…æ¡†æ¶çš„å¼€å‘è€…

ä½ éƒ½  
**ç¦»ä¸å¼€å·¥ç¨‹åŒ–**

## ä»€ä¹ˆæ˜¯å‰ç«¯å·¥ç¨‹åŒ–
ç®€å•ç†è§£ï¼Œå°±æ˜¯å¦‚ä½•æ­å»ºä¸€ä¸ªé¡¹ç›®çš„éª¨æ¶ï¼Œé…å¥½å¼€å‘ç¯å¢ƒã€‚
å¯¹äºåº“æˆ–è€…æ¡†æ¶çš„å¼€æºå¼€å‘è€…ï¼Œè¿˜è¦è€ƒè™‘npmå‘ç‰ˆã€å¤šä¸ªpackageç®¡ç†ã€‚

## ç»†èŠ‚

### æ‰“åŒ… 
å¸¸è§çš„æ‰“åŒ…å·¥å…·æœ‰ webpack, rollup, swc, esbuildç­‰ã€‚

æ— è®ºä½ ä½¿ç”¨ js å¼€å‘npmé¡¹ç›®ï¼Œè¿˜æ˜¯ä½¿ç”¨ typescript å¼€å‘é¡¹ç›®ï¼Œæœ€ç»ˆåˆ©ç”¨æ‰“åŒ…å™¨ç”Ÿæˆçš„æœ€ç»ˆä»£ç éƒ½æ˜¯ js ä»£ç ã€‚è€Œæœ€ç»ˆç”Ÿæˆçš„ js ä»£ç æ‰æ˜¯è¦ä¼ åˆ° npm registryçš„å†…å®¹ã€‚

ä¾‹å­ä¸€ï¼š
ä½ ä½¿ç”¨ js å¼€å‘ä¸€ä¸ªåº“ï¼Œæ²¡æœ‰ä½¿ç”¨åˆ°ä»»ä½•æ‰“åŒ…å·¥å…·ï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æŠŠå…¥å£jsæ–‡ä»¶ä»¥åŠå®ƒæ‰€ä¾èµ–çš„jsæ–‡ä»¶ä¼ åˆ° npm registryã€‚

ä¾‹å­äºŒï¼š
ä½ ä½¿ç”¨ js å¼€å‘ä¸€ä¸ªåº“ï¼Œä½†æ˜¯ä½ ä¸æƒ³è®©ç”¨æˆ·åœ¨ npm install åï¼Œçœ‹åˆ°ä¸‹è½½çš„ä»£ç æ˜¯æºç ï¼Œæˆ–è€…ä½ æƒ³æŠŠåˆ†æ•£çš„jsæ–‡ä»¶åˆä¸ºä¸€ä¸ªjsæ–‡ä»¶å‘å¸ƒåˆ° npm registryï¼Œé‚£ä¹ˆä½ å°±éœ€è¦æ‰“åŒ…å™¨å°†ä»£ç æ‰“åŒ…ï¼Œè€Œä¸”åªéœ€è¦å°†æ‰“åŒ…åçš„ä»£ç å‘å¸ƒï¼Œæºç ä¸è¦å‘å¸ƒã€‚

éƒ¨åˆ†å†…å®¹è¿™é‡Œæ²¡æœ‰è¯´æ¸…ï¼Œä¼šåœ¨åæ–‡ä¸­åˆ†æ•£ä»‹ç»ã€‚
### package.json 
#### private: true çš„æƒ…å½¢
1. ä½ çš„é¡¹ç›®ä¸ä¼šå‘å¸ƒåˆ°npmä¸Šï¼Œåªä¼šé€šè¿‡æ‰“åŒ…å·¥å…·ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„ä»£ç éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼›
2. ä½ çš„é¡¹ç›®æ˜¯å¤špackageç®¡ç†çš„æ ¹é¡¹ç›®ï¼Œå„ä¸ªpackageè¦å‘å¸ƒåˆ°npmä¸Šï¼Œæ ¹é¡¹ç›®æ— éœ€å‘å¸ƒ
   > è¿™ä¸ªæƒ…å½¢ä¸‹ï¼Œä½ è¿˜è¦æŒ‡å®š workspaceï¼Œäº¤ä»£å¤šä¸ª package åˆ†å¸ƒåœ¨å“ªäº›æ–‡ä»¶å¤¹ä¸‹ï¼Œä¸€èˆ¬éƒ½æ˜¯æ”¾åœ¨ä¸€ä¸ªå« packages çš„æ–‡ä»¶å¤¹ä¸‹ã€‚

#### workspace 
```json
{
   "name": "packageA",
   "private": true,
   "workspace": [
      "./package/*"
   ]
}
```
è¡¨ç¤ºpackageæ–‡ä»¶å¤¹ä¸‹çš„æ¯ä¸ªæ–‡ä»¶å¤¹ï¼Œéƒ½å¸¦æœ‰ package.json æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›æ–‡ä»¶å¤¹éƒ½æ˜¯ä¸€ä¸ªnpmåŒ…ã€‚

#### engines
å¼ºçƒˆå»ºè®®è®¾ç½®æ­¤é€‰é¡¹ã€‚å½“ä½ æ­èµ·ä¸€ä¸ªé¡¹ç›®ï¼Œè®¾ç½®å¥½ç ”å‘ç¯å¢ƒæ—¶ï¼Œä½ å®‰è£…ä¾èµ–çš„åº“å¯èƒ½å¯¹nodeç‰ˆæœ¬æœ‰è¦æ±‚ã€‚å¦‚æœå¦å¤–æœ‰ä¸€ä¸ªäººæ‹‰å–ä½ çš„é¡¹ç›®ï¼Œæƒ³åšäº›è´¡çŒ®ï¼Œå¾ˆå¯èƒ½è¢«æœ¬åœ°nodeç‰ˆæœ¬å·å‘åˆ°ï¼Œæ— æ³•é¡ºåˆ©å®‰è£…ä¾èµ–åº“ã€‚é€šè¿‡enginesæŒ‡å®šå¥½ç‰ˆæœ¬ï¼Œå¯ä»¥ææ—©ç»™å‡ºæç¤ºï¼Œå…ˆè¡Œå‘ŠçŸ¥ç”¨æˆ·å‡çº§nodeã€‚

#### main
å½“ä½ å¼€å‘çš„npmé¡¹ç›®æ˜¯ä¸€ä¸ªåº“æ—¶ï¼Œä½ è¦æŒ‡å®šè¿™ä¸€é¡¹ï¼Œè¡¨æ˜åº“çš„å…¥å£æ–‡ä»¶ã€‚è¿™æ ·ï¼Œå½“åˆ«äººnpm install ä½ çš„åº“åï¼Œä½¿ç”¨requireå¼•ç”¨ä½ çš„åº“ï¼Œnodeæ‰çŸ¥é“åº”è¯¥å¼•å…¥å“ªä¸ªæ–‡ä»¶ã€‚

#### files
å½“ä½ ä½¿ç”¨ npm publish å‘å¸ƒè‡ªå·±çš„npmé¡¹ç›®æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†ä½ é¡¹ç›®ä¸­çš„æ‰€æœ‰åˆç†æ–‡ä»¶å¤¹æ‰“åŒ…æˆ tarï¼Œç„¶åå°†taråŒ…ä¸Šä¼ åˆ°registryã€‚åˆ«äºº npm install çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å…ˆä¸‹è½½è¿™ä¸ª taråŒ…ï¼Œç„¶åè§£å‹æ¢å¤æˆæ–‡ä»¶å¤¹ã€‚  
filesçš„ä½œç”¨å°±æ˜¯å‘Šè¯‰ npm publish, é¡¹ç›®ä¸­åˆ°åº•å“ªäº›æ–‡ä»¶è¦è¢«æ‰“åŒ…ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ`.gitignore` `.git`ç­‰æ–‡ä»¶ä¸ä¼šè¢«æ‰“åŒ…ã€‚

#### type
æŒ‡å®šä½ çš„npmé¡¹ç›®é‡‡ç”¨å“ªç§æ¨¡å—åŒ–ç®¡ç†æ–¹å¼ï¼Œ"module" æˆ–è€… "commonjs"ï¼Œ**åªèƒ½äºŒé€‰ä¸€**ï¼å¦‚æœä½ æŒ‡å®šäº† â€œmoduleâ€ï¼Œå¯å®é™…ä¸Šä»£ç ç”¨çš„æ˜¯commonJSçš„æ–¹å¼ï¼Œnodeä¼šåœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­æŠ¥é”™ï¼Œä½†æ˜¯åœ¨vscodeç¼–ç è¿‡ç¨‹ä¸­ä¸ä¼šæŠ¥é”™ã€‚  
å¦‚æœä½ æ²¡æœ‰æŒ‡å®štype, é»˜è®¤ä¸º commonjs.
> åœ¨ node v12.0.0å¼€å§‹ï¼Œä½ å¯ä»¥ç”¨ module çš„æ¨¡å—åŒ–ç®¡ç†æ–¹å¼ï¼Œç¼–å†™nodejsä»£ç ï¼›
> ç”šè‡³åœ¨ä¸€ä¸ª .cjs æ–‡ä»¶ä¸­ç”¨ commonjsçš„æ–¹å¼å¯¼å‡ºæ¨¡å—ï¼Œåœ¨å¦ä¸€ä¸ª.jsä»£ç ä¸­ä½¿ç”¨ module æ–¹å¼å¯¼å…¥ï¼›
> å¯¹äº .cjs æ–‡ä»¶ï¼ŒæŒ‰ç…§ commonjs ç»„ç»‡æ¨¡å—ï¼›
> å¯¹äº .ejs æ–‡ä»¶ï¼ŒæŒ‰ç…§ module ç»„ç»‡æ¨¡å—ï¼›
> å¯¹äº .js æ–‡ä»¶ï¼ŒæŒ‰ç…§ type æŒ‡å®šçš„æ¨¡å—åŒ–æ–¹å¼ç»„ç»‡ï¼›

**æ³¨æ„ï¼š**
å¦‚æœä½ åœ¨ .js æ–‡ä»¶ä½¿ç”¨ module æ–¹å¼å¯¼å‡ºï¼Œåœ¨å¦ä¸€ä¸ª .js æ–‡ä»¶ä¸­ä½¿ç”¨ commonjs æ–¹å¼å¯¼å…¥ï¼Œéœ€è¦ä½¿ç”¨ @babel/register è¿™æ ·çš„å·¥å…·è¿›è¡ŒåŠæ—¶ç¼–è¯‘ï¼Œå¦åˆ™æŠ¥é”™ï¼

#### types 
ç¬¬ä¸‰æ–¹å·¥å…·æ‰€éœ€å­—æ®µã€‚
è¿™ä¸ªå­—æ®µä¾› typescript ä½¿ç”¨ã€‚

å¦‚æœä½ çš„åº“è¦ä¾›ç»™typescriptä½¿ç”¨ï¼Œéœ€è¦ä¸ºä½ çš„jsåº“åŠ å…¥å£°æ˜æ–‡ä»¶ï¼Œè€Œtypeså°±æ˜¯æŒ‡å‡ºå£°æ˜æ–‡ä»¶çš„ä½ç½®ã€‚

#### module
å½“åˆ«äººç”¨ module æ¨¡å—åŒ–æ–¹å¼å¯¼å…¥ä½ çš„åº“æ—¶ï¼Œ module å°†å‘Šè¯‰ node å…¥å£æ–‡ä»¶åœ¨å“ªé‡Œã€‚
#### exports
node v14.13.0å¼€å§‹æ”¯æŒçš„å­—æ®µã€‚
exports å­—æ®µå¯ä»¥é…ç½®ä¸åŒç¯å¢ƒå¯¹åº”çš„æ¨¡å—å…¥å£æ–‡ä»¶ï¼Œå¹¶ä¸”å½“å®ƒå­˜åœ¨æ—¶ï¼Œå®ƒçš„ä¼˜å…ˆçº§æœ€é«˜ã€‚
```json
{
   "name": "packageA",
   "exports": {
      ".": {
         "require": "./dist/main.common.js",
         "import": {
            "node": "./dist/main.m.js",
            "default": "./dist/main.esm.js"
         },
         "types": "./dist/types/index.d.ts"
      },
      "./css/*": "./dist/css/*",
   }
}
```
åœ¨nodeç¯å¢ƒï¼Œä½¿ç”¨`import "packageA"`,ä¼šå¼•å…¥ `./dist/main.m.js`;
åœ¨nodeç¯å¢ƒï¼Œä½¿ç”¨`require("packageA")`ä¼šå¼•å…¥`./dits/main.common.js`ï¼›
å¦‚æœæ˜¯ node + typescript ç¯å¢ƒï¼Œä½¿ç”¨ `import "packageA"`ï¼Œä¼šå¼•å…¥`./dist/main.esm.js`ï¼Œå£°æ˜æ–‡ä»¶ä» `./dist/types/index.d.ts`å»æ‰¾ã€‚
åœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œé€šè¿‡cdnå¼•å…¥çš„æ˜¯ `./dist/main.esm.js`ï¼›

#### packageManager
è¯¥å­—æ®µå‘Šè¯‰åˆ«äººä½ ä½¿ç”¨ä»€ä¹ˆåŒ…ç®¡ç†å·¥å…·ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µå¹¶ä¸ä¼šé˜»æ­¢åˆ«äººç”¨å…¶å®ƒåŒ…ç®¡ç†å·¥å…·ã€‚  
æ¯”å¦‚ï¼Œpackage.json
```json
{
  "packageManager": "yarn@1.20.2",
  "scripts": {
   "dev": "node index.js"
  }
}
```
åˆ«äººä¾æ—§å¯ä»¥æ­£å¸¸æ‰§è¡Œ`npm run dev`

#### unpkg
è¿™æ˜¯ç¬¬ä¸‰æ–¹å·¥å…·è¦åœ¨package.jsonä¸­ç”¨åˆ°çš„å­—æ®µï¼Œpackage.jsonæœ¬èº«å¹¶æ²¡æœ‰å®šä¹‰è¯¥å­—æ®µã€‚
`unpkg`æŒ‡å®šå…¥å£æ–‡ä»¶ã€‚å½“ç”¨æˆ·ä½¿ç”¨unpkgå®˜ç½‘çš„cdnå‘æµè§ˆå™¨ä¸­å¯¼å…¥npmåŒ…çš„æ—¶å€™ï¼Œå°±ä¼šå°†`unpkg`æŒ‡å®šçš„æ–‡ä»¶å¯¼å…¥ã€‚
```json
{
   "name": "packageA",
   "unpkg": "./dist/main.esm.js",
}
```
è‹¥`<script src="http://unpkg.com/packageA" />`ï¼Œå°±ä¼šå°†packageAé¡¹ç›®ä¸­çš„`dist/main.esm.js`æ–‡ä»¶å¯¼å…¥ã€‚


#### jsdelivr
ç¬¬ä¸‰æ–¹å·¥å…·æ‰€éœ€å­—æ®µã€‚  
`jsdelivr`æŒ‡å®šå…¥å£æ–‡ä»¶ã€‚å½“ç”¨æˆ·ä½¿ç”¨jsdelivrå®˜ç½‘çš„cdnå‘æµè§ˆå™¨å¯¼å…¥npmåŒ…çš„æ—¶å€™ï¼Œå°±ä¼šå°†`jsdelivr`æŒ‡å®šçš„æ–‡ä»¶å¯¼å…¥ã€‚
```json
{
   "name": "packageA",
   "jsdelivr": "./dist/main.esm.js",
}
```
è‹¥`<script src="http://cdn.jsdelivr.net/npm/packageA" />`, å°±ä¼šå°†packageAé¡¹ç›®ä¸­çš„`dist/main.esm.js`æ–‡ä»¶å¯¼å…¥ã€‚

#### browserslist
ç¬¬ä¸‰æ–¹å·¥å…·æ‰€éœ€å­—æ®µã€‚  
æŒ‡å®šæµè§ˆå™¨å…¼å®¹æ€§ã€‚  
å½“ä½¿ç”¨babelç¼–è¯‘ä»£ç æ—¶ï¼Œéœ€è¦çŸ¥é“ç¼–è¯‘æˆå’Œä»€ä¹ˆæ ·çš„æµè§ˆå™¨å…¼å®¹çš„ä»£ç ï¼Œæ­¤æ—¶babelå°±ä¼šè¯»å–package.jsonä¸­çš„ `browserslist`å­—æ®µã€‚å½“ç„¶ï¼Œä½ å¯ä»¥ä¸ç”¨å†™åœ¨package.jsonä¸­ï¼Œå•ç‹¬æ”¾åœ¨`.browserslistrc`æ–‡ä»¶ä¸­ã€‚
```json
{
   "name": "packageA",
   "browserslist": [
      ">5%",
      "last 1 version"
   ]
}
```

#### sideEffects
ç¬¬ä¸‰æ–¹å·¥å…·æ‰€éœ€å­—æ®µã€‚
æŒ‡å®šæœ‰å‰¯ä½œç”¨çš„æ–‡ä»¶æœ‰å“ªäº›ï¼Œé˜»æ­¢webpackå¯¹è¿™äº›æ–‡ä»¶çš„tree-shakingã€‚
æ¯”å¦‚ä½¿ç”¨ webpack æ‰“åŒ…çš„æ—¶å€™ï¼Œå¦‚æœ `import css from "packageA/css"` å¼•å…¥æŸä¸ªåŒ…ä¸‹é¢çš„cssèµ„æºï¼Œå¯æ˜¯webpackå‘ç°ä½ æ²¡æœ‰ä½¿ç”¨ï¼Œå°±ä¸ä¼šæŠŠè¿™äº›cssèµ„æºæ‰“åŒ…ï¼Œæ­¤æ—¶è®¾ç½® `sideEffects: ["*.less", "*.scss", "*.stylus"]`ï¼Œå‘Šè¯‰webpackè¿™äº›æ–‡ä»¶æœ‰å‰¯ä½œç”¨ï¼Œåˆ«å¯¹å®ƒä»¬ä½¿ç”¨tree-shakingã€‚

#### lint-staged
ç¬¬ä¸‰æ–¹å·¥å…·æ‰€éœ€å­—æ®µã€‚
é…ç½® `lint-staged`å·¥å…·å¯¹gitæš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œåšå“ªäº›æ“ä½œã€‚
```json
{
   "name": "packageA",
   "lint-staged": {
      "src/**/*.{js,jsx,ts,tsx}": [
         "eslint --fix",
         "prettier --write",
         "git add -A"
      ],
   }
}
```
> ä¸è¦å¿˜è®° `npm install lint-staged`

<br>

### å·¥ç¨‹åŒ–å¿…å¤‡å·¥å…·
#### babel 
jsçš„ç¼–è¯‘å™¨ã€‚
* å°†æºä»£ç è½¬åŒ–ä¸ºæŒ‡å®šæ¨¡å—åŒ–æ ¼å¼çš„jsä»£ç ï¼›
  > ä½ ç”¨ commonjsä»£ç å†™çš„ï¼Œå®ƒå¯ä»¥è½¬ä¸º module æ¨¡å—é£æ ¼çš„ä»£ç ï¼›
* å°†æºä»£ç è½¬åŒ–ä¸ºæŒ‡å®šæ ‡å‡†çš„jsä»£ç ï¼›
  > ä½ ç”¨æ–°çš„esè¯­æ³•æ ‡å‡†å†™çš„ä»£ç ï¼Œå®ƒå¯ä»¥è½¬ä¸º es5 ä»£ç ï¼›

ä¸€èˆ¬ä¸å•ç‹¬ä½¿ç”¨ï¼Œä¼šåœ¨å‰ç«¯æ„å»ºå·¥å…·ç”Ÿæ€ä¸­ä½œä¸ºæ’ä»¶æˆ–è€…loaderä½¿ç”¨ã€‚

å•ç‹¬ä½¿ç”¨æ—¶ï¼Œä¸€èˆ¬æ˜¯æœ‰è¦è‡ªå®šä¹‰ä¿®æ”¹ASTçš„éœ€æ±‚ï¼Œç”Ÿæˆç‰¹åˆ«çš„jsä»£ç ã€‚è¿™æ—¶å€™å¸¸ç”¨@babel/parseråŒ…ï¼Œç”¨å®ƒæä¾›çš„APIï¼Œåœ¨nodejsç¯å¢ƒä»£ç ä¸­å»å®ç°ã€‚

æ›´å¤šä¿¡æ¯å‚è€ƒ [é…ç½®æ–‡ä»¶.md](./%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6.md)


#### eslint 
ä¸€ä¸ª js æˆ–è€… ts çš„è¯­æ³•æ£€æµ‹å™¨ã€‚
* é…åˆvs codeä¸­çš„ eslint æ’ä»¶ï¼Œåœ¨ä½ ç¼–å†™ js æˆ–è€… ts ä»£ç æ—¶ï¼Œæ£€æµ‹ä¹¦å†™çš„è¯­æ³•é”™è¯¯ï¼Œç»™å‡ºè‡ªåŠ¨ä¿®æ”¹æ ¼å¼åŒ–ï¼›
* é…åˆ eslintçš„ typescript æ’ä»¶ï¼Œæ‰å¯ä»¥æ£€æµ‹åˆ° ts çš„è¯­æ³•é—®é¢˜ï¼›
  > å¦‚æœä½¿ç”¨ eslintæ£€æµ‹  ts è¯­æ³•é—®é¢˜äº†ï¼Œå°±ä¸éœ€è¦åœ¨ tsconfig.json é…ç½®ç±»å‹æ£€æµ‹æ–¹é¢çš„å‚æ•°äº†ã€‚
* å¤šé…åˆ eslint çš„ prettier æ’ä»¶ï¼Œå¯¹ ä»£ç é£æ ¼è¿›è¡Œæ£€æµ‹å¹¶ä¿®æ”¹ï¼›
  > æ­¤æ—¶ä¸éœ€è¦åŠ å…¥ prettier é…ç½®æ–‡ä»¶äº†

eslint çš„CLIä¸€èˆ¬é…ç½®åœ¨package.jsonçš„ scriptsä¸­ï¼Œç”¨äºå¯¹æŒ‡å®šçš„æ–‡ä»¶åšä¸€æ¬¡æ•´ä½“æ£€æµ‹ï¼Œè€Œä¸æ˜¯ä¾èµ–vscode eslintæ’ä»¶åœ¨ä¹¦å†™ä»£ç çš„æ—¶å€™æ£€æµ‹ã€‚

åœ¨ lint-staged å¸¸ä¼šç”¨åˆ° eslint CLIï¼Œå¯¹æš‚å­˜åŒºçš„æ–‡ä»¶åšæ•´ä½“æ£€æµ‹ã€‚
> æ–‡ä»¶è¶Šå¤šï¼Œeslintæ•´ä½“æ£€æµ‹ä¸€éçš„æ—¶é—´è¶Šé•¿ï¼›ä½†å®é™…ä¸Šï¼Œæš‚å­˜åŒºçš„æ–‡ä»¶å¹¶ä¸å¤šï¼Œæ‰€ä»¥è¦è¿™ä¹ˆåšã€‚

FAQğŸ¤”ï¼š   
1. ä¸ºä»€ä¹ˆä½¿ç”¨äº†eslintï¼Œè¿˜è¦ä½¿ç”¨prettierå‘¢ï¼Ÿ
   è¿™ä¸ªæ˜¯ä»¤äººéå¸¸å›°æƒ‘çš„äº‹æƒ…ã€‚  
   eslintæœ¬èº«é™¤äº†ä»£ç è¯­æ³•æ£€æµ‹ä¹‹å¤–ï¼Œä¹Ÿæ”¯æŒæ ¼å¼åŒ–ã€‚  
   prettierä¸“æ³¨äºä»£ç çš„æ ¼å¼åŒ–ã€‚  
     
   eslint ä¸»è¦æ£€æµ‹ js ä»£ç è¯­æ³•æ˜¯å¦æœ‰é”™è¯¯ï¼Œå¦‚æœæœ‰é”™è¯¯ï¼Œå¯ä»¥è¿›è¡Œçº æ­£ï¼Œä¹Ÿå°±æ˜¯æ ¼å¼åŒ–ã€‚ä½†æ˜¯eslintæ²¡æœ‰åŠæ³•æ£€æµ‹åˆ° tsã€cssã€less ç­‰å…¶ä»–è¯­è¨€çš„è¯­æ³•é”™è¯¯ã€‚  
   
   * å¦‚æœè¦æ£€æµ‹tsè¯­æ³•é”™è¯¯ï¼Œå¹¶ä¸”çº æ­£è¯­æ³•é”™è¯¯:
     * å¿…é¡»è¦å®‰è£…eslintçš„tsæ’ä»¶`@typescript-eslint/eslint-plugin` å’Œ `@typescript-eslint/parser`;
     * è¿˜è¦å®‰è£…tsç¼–è¯‘å™¨`npm install -D typescript`;
     * å¾€extendså‚æ•°åŠ å…¥ `plugin: @typescript-eslint/recommended`;
     * å¾€parser å‚æ•°åŠ å…¥ `@typescript-eslint/parser`ã€‚  
     * 
   * å¦‚æœæƒ³çº æ­£å¤„ç†`jsï¼Œts`çš„ä»£ç é£æ ¼ï¼Œæ¯”å¦‚ä¸è¯¥ç¼©è¿›çš„åœ°æ–¹ç¼©è¿›äº†ï¼Œä½ æƒ³åœ¨vscodeä¸€ä¿å­˜ä»£ç ï¼Œå°±ç›´æ¥æ ¼å¼åŒ–ä¸ºæ­£ç¡®çš„é£æ ¼ï¼Œå°±å¿…é¡»ä½¿ç”¨eslintçš„prettieræ’ä»¶:
     * å®‰è£…`eslint-plugin-prettier`;
     * å®‰è£…`prettier`;
     * å®‰è£…`eslint-config-prettier`;
     * å¾€extends å‚æ•°åŠ å…¥ `plugin: prettier/recommended`;
     * å¾€plugin å‚æ•°åŠ å…¥ `prettier`ï¼›
     > `plugin: prettier/recommended`å­˜åœ¨é»‘é­”æ³•ğŸ‘‡ https://github.com/prettier/eslint-plugin-prettier#recommended-configuration ï¼›
     > è¿™ä¸ªé»‘é­”æ³•ä»¤é…ç½®ä¸­çœ‹ä¸åˆ° `eslint-config-prettier`çš„è¸ªå½±ï¼Œä½†å®é™…ä¸Šç¡®å®ç”¨åˆ°äº†å®ƒï¼›
     * è¿˜è¦é…ç½®vscode
       * åœ¨settingsä¸­è¾“å…¥`editor.save`ï¼Œä¿è¯`formatOnSave`âœ…;
       * åœ¨settingsä¸­è¾“å…¥`editor.defaultFormat`, ä¿è¯`Default Formatter` æ˜¯ `ESLint` æˆ–è€… `Prettier ESLint`
      > æ‰¾ä¸åˆ°è¿™ä¸¤ä¸ªé€‰é¡¹ï¼Œè¯·å®‰è£…vscodeçš„ ESLint æ’ä»¶ï¼Œ Prettier ESlintæ’ä»¶ï¼Œ Prettier æ’ä»¶ï¼›

2. æ€ä¹ˆæ£€æµ‹cssã€lessã€scssçš„é”™è¯¯ï¼Œæ ¼å¼åŒ–ä»£ç é£æ ¼ï¼Ÿ
åœ¨ä¸Šä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬åŠ å…¥äº† `plugin: prettier/recommended`, å¼•å…¥äº† prettier ræ¨èçš„é…ç½®ï¼Œè¿™ä¸ªé…ç½®ä¸­å°±åŒ…å«ç€  css less scss çš„æ ¼å¼åŒ–è®¾ç½®ï¼Œå› æ­¤ä¸Šä¸ªé—®é¢˜é…ç½®å¥½åï¼Œå°±å¯ä»¥ç›´æ¥ä¿å­˜ï¼Œæ ¼å¼åŒ–è¿™äº›æ–‡ä»¶äº†ã€‚æ¨èçš„é…ç½®ä¸­ï¼Œè¿˜æ”¯æŒ` markdown `æ–‡ä»¶ã€‚
stylusæ˜¯ä¸ªä¾‹å¤–ã€‚éœ€è¦å•ç‹¬å®‰è£… vscode çš„ stylus æ’ä»¶ã€‚ä¸è¿‡æœ¬äººå—ä¸äº† stylus çš„å¤æ€ªè¯­æ³•ï¼Œä¸ä¼šä½¿ç”¨è¯¥å·¥å…·ï¼Œå°±ä¸ä»‹ç»å¦‚ä½•é…ç½®äº†ï¼Œ
æ¬¢è¿è¡¥å……ï¼šğŸ‘‡
   ```

   ```


#### rollup 
å¸¸ç”¨äº åº“æˆ–è€…æ¡†æ¶ çš„æ‰“åŒ…å·¥å…·ã€‚
åŸç”Ÿæ”¯æŒ es6 æ ‡å‡†ä¸‹çš„jsä»£ç æ‰“åŒ…ï¼Œä¸æ”¯æŒå…¶ä»–èµ„æºçš„ä»£ç ï¼Œå¦‚ .css .png .jpeg .mp3;

å¦‚æœè¦æ‰“åŒ…tsï¼Œéœ€è¦å¼•å…¥ rollupçš„ typescript æ’ä»¶`rollup-plugin-typescript` æˆ–è€… `rollup-plugin-typescript2`ï¼›

å¦‚æœæ”¯æŒ es5 çš„ api pollyfillï¼Œ éœ€è¦åŠ å…¥ rollupçš„ babel æ’ä»¶`rollup-plugin-babel`;


#### esbuild 
ä½¿ç”¨goå®ç°çš„jsæ‰“åŒ…å™¨ã€‚
åœ¨ vite ä¸­å¾—åˆ°åº”ç”¨ã€‚

#### swc 

#### parcel

#### webpack 
æœ€æˆç†Ÿçš„æ„å»ºå·¥å…·ã€‚
æ”¯æŒçš„èŒƒå›´éå¸¸å¹¿ï¼Œæ— æ‰€ä¸åŒ…ï¼Œç”Ÿæ€æœ€å¥½ã€‚
å¯ä»¥æ‰“åŒ…jsï¼Œ ä¹Ÿå¯ä»¥æ‰“åŒ… tsï¼Œ è¿˜å¯ä»¥æ‰“åŒ… .css .png .jpeg .mp4 ç­‰ç­‰é™æ€èµ„æºï¼Œåªéœ€è¦å¼•å…¥å¯¹åº”çš„ plugin æˆ–è€… loaderã€‚
å’Œ rollup ä¸åŒçš„æ˜¯ï¼Œä¸»å¼ æ‹†åŒ…ï¼Œå¤šä½œä¸ºå‰ç«¯ app å¼€å‘çš„æ„å»ºå·¥å…·ã€‚

## å‰ç«¯å·¥ç¨‹åŒ–çš„å…·ä½“åœºæ™¯
### æµè§ˆå™¨ç«¯jsåº“å¼€å‘
å‘ï¼šç ”å‘çš„ä»£ç æ˜¯æŒ‰ç…§ es6 æ¨¡å—åŒ–ç»„ç»‡çš„ï¼Œä½†æ˜¯å•å…ƒæµ‹è¯•çš„ä»£ç æ˜¯è·‘åœ¨ node ç¯å¢ƒä¸Šçš„ï¼Œå•å…ƒæµ‹è¯•ä»£ç ä¸­è‚¯å®šè¦å¼•ç”¨æ¨¡å—ï¼Œä¼šäº§ç”Ÿå¼•å…¥å†²çªã€‚
æ–¹æ³•ï¼šä¸€èˆ¬å•å…ƒæµ‹è¯•æ¡†æ¶éƒ½ä¼šè€ƒè™‘åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæä¾›ç›¸åº”çš„å‘½ä»¤è¡Œé€‰é¡¹ï¼Œå®Œæˆå¯¹ require çš„æ‹¦æˆªå’Œä»£ç åŠæ—¶ç¼–è¯‘ã€‚ä»¥mochaä¸ºä¾‹ï¼Œæä¾› --requireé€‰é¡¹ï¼ŒæŒ‡å®šè¯¥é€‰é¡¹ä¸º @babel/register, å°±å¯ä»¥åœ¨æ‰§è¡Œ require æ—¶ï¼Œå°†å¼•å…¥çš„æ¨¡å—åŠæ—¶ç¼–è¯‘ä¸º commonJSé£æ ¼ï¼Œä¾› node ä½¿ç”¨ã€‚
> è®°å¾— npm install -D @babel/register 
> å…¶ä»–æµ‹è¯•æ¡†æ¶è¦é˜…è¯»å®˜æ–¹ä»‹ç»

### node js åº“å¼€å‘ 
### umd js åº“å¼€å‘
æœ€ç»ˆæ˜¯æµè§ˆå™¨ç«¯è¿˜æ˜¯nodeç«¯ï¼Œè¿˜æ˜¯ umd åŒ–ï¼Œåªå’Œæ‰“åŒ…å™¨çš„é…ç½®ç›¸å…³ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»£ç æŒ‰ç…§ es6 é£æ ¼æˆ–è€… commonJS é£æ ¼å†™ï¼Œæœ€åé€šè¿‡é…ç½®æ‰“åŒ…å™¨ï¼Œè®¾å®šå¥½æœ€ç»ˆç¼–è¯‘å¥½çš„ä»£ç æ˜¯ä»€ä¹ˆé£æ ¼ã€‚
> åº“å¼€å‘ï¼Œå¸¸ç”¨ rollup æ‰“åŒ…ï¼›
> appå¼€å‘ï¼Œå¸¸ç”¨ webpack æ‰“åŒ…ï¼›
> rollupæ˜¯å°†åˆ†æ•£åœ¨å„ä¸ªæ¨¡å—ä¸­çš„ä»£ç é›†ä¸­èµ·æ¥å¯¼å‡ºï¼›
> webpackæ˜¯ä»£ç åˆ†å‰²ï¼ŒæŒ‰éœ€åŠ è½½ã€‚
> ç”±äºåº“ä»£ç æœ¬èº«ä¸ä¼šæœ‰å¤šå¤§ï¼Œå› æ­¤ç”¨rollupé‚£å¥—æ¯”è¾ƒå¥½ã€‚
### node command line å¼€å‘
### ä¸Šè¿°æƒ…å½¢è½¬ç”¨ typescriptå¼€å‘
ä¸¤ç§ç­–ç•¥:
1. å¼•å…¥ typescript, @types/typescript, ts-node(éå¿…éœ€),@typescript-eslint/eslint-plugin;
   > ä½¿ç”¨ tsc å¯¹ ts è¿›è¡Œç¼–è¯‘
2. å¼•å…¥ @babel/preset-typescript
   > ä½¿ç”¨ babel å’Œ @babel/plugin-transform-typescript æ’ä»¶å¯¹ ts è¿›è¡Œç¼–è¯‘ï¼›
   > é¢„è®¾ @babel/preset-typescript åŒ…å«æ’ä»¶@babel/plugin-transform-typescriptï¼›

## FAQğŸ¤”

### 1. ä½¿ç”¨ vscode å†™ nodejs ç¨‹åºï¼Œä»£ç æ²¡æœ‰æ™ºèƒ½æç¤ºï¼Ÿ
ä½¿ç”¨nodejsæ ‡å‡†åº“çš„æŸä¸ªå‡½æ•°æ—¶ï¼Œå¯èƒ½å¿˜è®°å…·ä½“æ€ä¹ˆä½¿ç”¨äº†ï¼Œåˆä¸æƒ³åˆ°å®˜ç½‘å»æŸ¥APIï¼Œæˆ‘ä»¬æœŸæœ› vscode ç»™å‡ºå‡½æ•°åŸå‹ï¼Œæä¾›ç»™æˆ‘ä»¬è¿™äº›ä¿¡æ¯ï¼š å‡½æ•°åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Œå‡½æ•°çš„å‚æ•°å…·ä½“é•¿ä»€ä¹ˆæ ·ï¼Œè¯¥å‡½æ•°ç”¨æ³•ä¸¾ä¾‹ã€‚

å…·ä½“æ¥è¯´ï¼Œå¦‚æœä½ åœ¨vscode ç›´æ¥ä¹¦å†™å¦‚ä¸‹ä»£ç ï¼Œé¼ æ ‡æ‚¬æµ®åœ¨ `createHttpServer` ä¸Šæ—¶ï¼Œä½ å¾—ä¸åˆ°ä»»ä½•æç¤ºï¼š
```js
const http = require("http")

http.createServer((req, res) => {})
```

å¦‚ä½•ç»™å‡ºæç¤ºå‘¢ï¼Ÿ

```bash
$ pnpm install -D @types/node
```
å°±æ˜¯è¿™ä¹ˆç®€å•ï¼
ä½ éƒ½ä¸éœ€è¦å†™æˆ ts æ–‡ä»¶ï¼

> åœ¨ ts æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨ import å’Œ require éƒ½å¯ä»¥å¼•ç”¨nodejs æ¨¡å—ï¼ŒåŒºåˆ«åœ¨äºï¼Œimport çš„æ–¹å¼ä¼šä¿ç•™ç±»å‹ä¿¡æ¯ï¼Œæ‹¥æœ‰æ™ºèƒ½æç¤ºï¼Œrequire ä¸ä¼šä¿ç•™ç±»å‹æç¤ºï¼›


### 2. æ€ä¹ˆå»ç†è§£ ts é…ç½®æ–‡ä»¶ä¸­ module å‚æ•° ï¼Ÿ
è¯¥å‚æ•°å°±æ˜¯æŒ‡å®š tsc ç¼–è¯‘å™¨äº§å‡ºä½•ç§ module ç®¡ç†é£æ ¼çš„jsä»£ç ï¼›

å¦‚æœæŒ‡å®š `CommonJS`, åœ¨æœ€ç»ˆä»£ç äº§ç‰©ä¸­ï¼Œä½ ä¼šçœ‹åˆ° `require` å‡½æ•°ï¼Œçœ‹ä¸åˆ° `import`;

å¦‚æœæŒ‡å®š `ES2015`ï¼Œåœ¨æœ€ç»ˆä»£ç äº§ç‰©ä¸­ï¼Œä½ ä¼šçœ‹åˆ° `import` ï¼Œ çœ‹ä¸åˆ° `require`;

è¿™ä»…ä»…æ˜¯æ¨¡å—ç®¡ç†å½¢å¼ä¸Šçš„ä¸€ä¸ªè¯­æ³•å˜åŒ–ã€‚

ä½†æ˜¯ï¼Œå¦‚æœæ¶‰åŠåˆ° nodeæ ‡å‡†åº“æ¨¡å— çš„å¼•å…¥ï¼ŒæŒ‡å®šå“ªç§é£æ ¼å…¨åœ¨äº `node` ç†è§£å“ªç§é£æ ¼ï¼› 

é»˜è®¤çŠ¶å†µä¸‹ï¼Œnodeåªèƒ½è¯†åˆ« CommonJSï¼Œå› æ­¤ç¼–è¯‘çš„ç»“æœï¼Œä½ ä¸å¾—ä¸é‡‡ç”¨ CommonJS ;
> node ä¹Ÿè¯†åˆ« `.mjs`, åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ esModule é£æ ¼çš„æ¨¡å—ç®¡ç†ï¼›

åŒç†ï¼Œæµè§ˆå™¨åªèƒ½è¯†åˆ« esModule æ¨¡å—ç®¡ç†é£æ ¼çš„ä»£ç ï¼Œå› æ­¤ç¼–è¯‘çš„ç»“æœï¼Œä½ ä¸å¾—ä¸é‡‡ç”¨ ES2015 ä¹‹ç±»çš„é£æ ¼ï¼›
> ESNextï¼Œ ES2016 ç­‰ç­‰


ts æ‰€åšçš„ä¸€ä»¶å¥½äº‹å°±æ˜¯åœ¨ç¼–ç é˜¶æ®µç»Ÿä¸€ä¸º import é£æ ¼ï¼Œåœ¨ç¼–è¯‘é˜¶æ®µå†è½¬åŒ–ä¸ºå…·ä½“ç¯å¢ƒæ‰€æ”¯æŒçš„é£æ ¼ï¼›